<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spin & Win | Fidelity</title>

<style>

:root{
    --green:#16a34a;
    --light:#22c55e;
}

/* PAGE */
body{
    margin:0;
    font-family:Poppins, sans-serif;
    background:linear-gradient(180deg,#ecfdf5,#ffffff);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.spin-container{
    text-align:center;
}

/* ===== LOGO ===== */
.logo{
    font-size:26px;
    font-weight:900;
    color:var(--green);
    margin-bottom:15px;
}

/* POINTER */
.pointer{
    width:0;height:0;
    border-left:16px solid transparent;
    border-right:16px solid transparent;
    border-bottom:32px solid var(--green);
    margin:auto;
    margin-bottom:-12px;
}

/* WHEEL */
.wheel{
    width:330px;
    height:330px;
    border-radius:50%;
    border:10px solid var(--green);
    position:relative;
    box-shadow:0 18px 50px rgba(0,0,0,.2);
    transition:transform 5s cubic-bezier(.17,.67,.12,.99);

    background:conic-gradient(
        #16a34a 0deg 45deg,
        #22c55e 45deg 90deg,
        #16a34a 90deg 135deg,
        #22c55e 135deg 180deg,
        #16a34a 180deg 225deg,
        #22c55e 225deg 270deg,
        #16a34a 270deg 315deg,
        #22c55e 315deg 360deg
    );
}

.prize{
    position:absolute;
    top:50%;
    left:50%;
    transform-origin:0 0;
    font-weight:800;
    color:#fff;
}

.prize span{
    position:absolute;
    transform:translate(-50%, -145px);
}

/* BUTTON */
.spin-btn{
    margin-top:28px;
    padding:14px 45px;
    border:none;
    border-radius:12px;
    font-size:18px;
    color:#fff;
    cursor:pointer;
    background:linear-gradient(135deg,#16a34a,#15803d);
    box-shadow:0 10px 20px rgba(0,0,0,.2);
}

.spin-btn:disabled{
    opacity:.6;
}

/* POPUP */
.reward-popup{
    position:fixed;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%) scale(.6);
    background:#fff;
    padding:25px 35px;
    border-radius:18px;
    font-size:26px;
    font-weight:800;
    color:var(--green);
    box-shadow:0 20px 60px rgba(0,0,0,.3);
    opacity:0;
    transition:.4s;
}

.reward-popup.show{
    opacity:1;
    transform:translate(-50%,-50%) scale(1);
}

/* CONFETTI */
.confetti{
    position:fixed;
    width:8px;
    height:8px;
    top:-10px;
    animation:fall 2s linear forwards;
}

@keyframes fall{
    to{
        transform:translateY(110vh) rotate(720deg);
        opacity:0;
    }
}

</style>
</head>

<body>

<div class="spin-container">

<div class="logo">Fidelity Rewards</div>

<div class="pointer"></div>

<div id="wheel" class="wheel">

<div class="prize" style="transform:rotate(22.5deg)"><span>â‚¹1K</span></div>
<div class="prize" style="transform:rotate(67.5deg)"><span>â‚¹2K</span></div>
<div class="prize" style="transform:rotate(112.5deg)"><span>â‚¹5K</span></div>
<div class="prize" style="transform:rotate(157.5deg)"><span>â‚¹10K</span></div>
<div class="prize" style="transform:rotate(202.5deg)"><span>â‚¹0</span></div>
<div class="prize" style="transform:rotate(247.5deg)"><span>â‚¹3K</span></div>
<div class="prize" style="transform:rotate(292.5deg)"><span>â‚¹15K</span></div>
<div class="prize" style="transform:rotate(337.5deg)"><span>â‚¹25K</span></div>

</div>

<button id="spinBtn" class="spin-btn" onclick="spinWheel()">SPIN</button>

</div>

<div id="rewardPopup" class="reward-popup"></div>

<script>

let spinning=false;

/* ===== REALISTIC PROBABILITY SYSTEM =====
   (Jackpot very rare like real apps)
*/
const rewardPool=[
 {value:1000, weight:35},
 {value:2000, weight:22},
 {value:3000, weight:15},
 {value:5000, weight:12},
 {value:10000,weight:8},
 {value:15000,weight:5},
 {value:25000,weight:2}, // jackpot rare
 {value:0,    weight:18}
];

function weightedReward(){

 let total=rewardPool.reduce((a,b)=>a+b.weight,0);
 let rand=Math.random()*total;

 for(const r of rewardPool){
   if(rand<r.weight) return r.value;
   rand-=r.weight;
 }
}

/* map reward â†’ wheel index */
const indexMap={
 1000:0,2000:1,5000:2,10000:3,
 0:4,3000:5,15000:6,25000:7
};

function confettiBlast(){
 for(let i=0;i<70;i++){
  const c=document.createElement("div");
  c.className="confetti";
  c.style.left=Math.random()*100+"%";
  c.style.background=`hsl(${Math.random()*360},70%,50%)`;
  document.body.appendChild(c);
  setTimeout(()=>c.remove(),2000);
 }
}

function spinWheel(){

 if(spinning) return;
 spinning=true;

 const btn=document.getElementById("spinBtn");
 btn.disabled=true;

 const wheel=document.getElementById("wheel");

 const reward=weightedReward();
 const winIndex=indexMap[reward];

 const slice=360/8;
 const stopAngle=360-(winIndex*slice)-(slice/2);
 const finalRotation=(5*360)+stopAngle;

 wheel.style.transform=`rotate(${finalRotation}deg)`;

 setTimeout(()=>{

   /* ===== WALLET CREDIT ===== */
   if(reward>0){
     let wallet=parseFloat(localStorage.getItem("wallet"))||0;
     wallet+=reward;
     localStorage.setItem("wallet",wallet);

     let tx=JSON.parse(localStorage.getItem("transactions"))||[];
     tx.unshift({
       type:"Spin Reward",
       amount:reward,
       status:"Completed",
       date:new Date().toLocaleString()
     });
     localStorage.setItem("transactions",JSON.stringify(tx));
   }

   const popup=document.getElementById("rewardPopup");
   popup.innerText =
      reward>0
      ? `ðŸŽ‰ You Won â‚¹${reward.toLocaleString("en-IN")}`
      : "ðŸ˜¢ Better Luck Next Time";

   popup.classList.add("show");

   if(reward>0) confettiBlast();

   setTimeout(()=>{
     popup.classList.remove("show");
     btn.disabled=false;
     spinning=false;
   },3000);

 },5000);
}

</script>

</body>
</html>
